
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>V∆∞·ª£t Ch∆∞·ªõng Ng·∫°i V·∫≠t - H·ªçc T·∫≠p Ti·∫øt Ki·ªám</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        @keyframes gradient-move {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .animate-gradient {
            background-size: 200% 200%;
            animation: gradient-move 8s ease infinite;
        }
        body {
            font-family: 'Nunito', sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
            user-select: none;
            background-color: #0c4a6e;
            touch-action: manipulation;
        }
        .font-bungee { font-family: 'Bungee', cursive; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake { animation: shake 0.2s ease-in-out 0s 2; }

        .ball-shadow {
            box-shadow: inset -10px -10px 20px rgba(0,0,0,0.3), 0 10px 20px rgba(0,0,0,0.2);
        }

        /* Ch·ªëng highlight khi nh·∫•n tr√™n mobile */
        * { -webkit-tap-highlight-color: transparent; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        // --- D·ªÆ LI·ªÜU C√ÇU H·ªéI ---
        const QUESTIONS = [
            { id: 1, text: "Theo t∆∞ t∆∞·ªüng H·ªì Ch√≠ Minh, vi·ªác l·∫≠p k·∫ø ho·∫°ch chi ti√™u c√° nh√¢n gi√∫p gi·ªõi tr·∫ª:", options: ["A. Chi ti√™u tho·∫£i m√°i theo c·∫£m x√∫c", "B. L√†m ch·ªß t√†i ch√≠nh, s·ªëng th·ª±c t·∫ø", "C. S·ªëng h∆∞·ªüng th·ª•", "D. Ch·ªâ quan t√¢m nh√£n hi·ªáu v√† tr√†o l∆∞u"], answer: "B" },
            { id: 2, text: "H·∫°n ch·∫ø ch·∫°y theo h√†ng hi·ªáu, tr√†o l∆∞u ti√™u d√πng xa x·ªâ l√† bi·ªÉu hi·ªán c·ªßa:", options: ["A. S·ªëng kham kh·ªï", "B. Ti·∫øt ki·ªám ti·ªÅn b·∫°c, s·ªëng th·ª±c t·∫ø", "C. S·ªëng h∆∞·ªüng th·ª•, ch·∫°y theo m·∫°ng x√£ h·ªôi", "D. Kh√¥ng quan t√¢m h·ªçc t·∫≠p"], answer: "B" },
            { id: 3, text: "T√°i s·ª≠ d·ª•ng ƒë·ªì d√πng c√≤n gi√° tr·ªã gi√∫p:", options: ["A. Ch·ªâ ti·∫øt ki·ªám ti·ªÅn", "B. Gi·∫£m l√£ng ph√≠, b·∫£o v·ªá m√¥i tr∆∞·ªùng", "C. L√£ng ph√≠ th·ªùi gian", "D. T·∫°o √°p l·ª±c d∆∞ lu·∫≠n"], answer: "B" },
            { id: 4, text: "Khi B√°c H·ªì d√πng b√°t ch√°o n·∫•u t·ª´ c∆°m ngu·ªôi, Ng∆∞·ªùi mu·ªën nh·∫Øn nh·ªß ƒëi·ªÅu g√¨ v·ªÅ l·ªëi s·ªëng?", options: ["A. Ti·∫øt ki·ªám, kh√¥ng l√£ng ph√≠ th·ª±c ph·∫©m", "B. H∆∞·ªüng th·ª• c√° nh√¢n", "C. Ch·ªâ quan t√¢m ƒë·∫øn s·ª©c kh·ªèe", "D. Ph√¥ tr∆∞∆°ng s·ª± gi·∫£n d·ªã"], answer: "A" },
            { id: 5, text: "N·∫øu h·ªçc sinh mu·ªën th·ª±c h√†nh nguy√™n t·∫Øc ‚Äú∆∞u ti√™n nhu c·∫ßu tr∆∞·ªõc mong mu·ªën‚Äù trong chi ti√™u, n√™n l√†m g√¨?", options: ["A. Mua t·∫•t c·∫£ nh·ªØng m√≥n ƒë·ªì th√≠ch ngay l·∫≠p t·ª©c", "B. Ch·ªâ mua nh·ªØng th·ª© th·ª±c s·ª± c·∫ßn thi·∫øt, chia ti·ªÅn h·ª£p l√Ω", "C. Ch·∫°y theo tr√†o l∆∞u m·∫°ng x√£ h·ªôi", "D. D√πng ti·ªÅn cho gi·∫£i tr√≠ h·∫øt"], answer: "B" },
            { id: 6, text: "B√°c H·ªì g·ª≠i ti·ªÅn ti·∫øt ki·ªám c·ªßa m√¨nh cho B·ªô Qu·ªëc ph√≤ng ƒë·ªÉ l√†m qu√† t·∫∑ng cho b·ªô ƒë·ªôi ph√≤ng kh√¥ng cho th·∫•y:", options: ["A. B√°c ch·ªâ quan t√¢m ƒë·∫øn b·∫£n th√¢n", "B. Ti·∫øt ki·ªám ch·ªâ ƒë·ªÉ d√πng ri√™ng", "C. Ti·∫øt ki·ªám ƒë·ªÉ d√πng v√¨ l·ª£i √≠ch chung v√† gi√∫p ƒë·ª° ng∆∞·ªùi kh√°c", "D. Ti·∫øt ki·ªám ƒë·ªÉ mua h√†ng hi·ªáu"], answer: "C" },
            { id: 7, text: "Vi·ªác B√°c H·ªì ƒë·ªçc b·∫£n tin r√¥n√™√¥ m·ªù nh√≤e nh∆∞ng v·∫´n d√πng ƒë·ªÉ vi·∫øt ho·∫∑c c·∫Øt th√†nh phong b√¨ ti·∫øt ki·ªám gi·∫•y th·ªÉ hi·ªán:", options: ["A. Kh√¥ng quan t√¢m ch·∫•t l∆∞·ª£ng th√¥ng tin", "B. L√£ng ph√≠ t√†i nguy√™n", "C. S·ªëng ti·∫øt ki·ªám, qu√Ω tr·ªçng gi·∫•y m·ª±c v√† ti·ªÅn b·∫°c", "D. Ch·ªâ quan t√¢m c√¥ng vi·ªác c√° nh√¢n"], answer: "C" },
            { id: 8, text: "C√¢u chuy·ªán b√† Nguy·ªÖn Th·ªã Li√™n v√° √°o g·ªëi, qu·∫ßn √°o cho B√°c H·ªì cho th·∫•y b√†i h·ªçc g√¨ v·ªÅ l·ªëi s·ªëng c·ªßa Ng∆∞·ªùi?", options: ["A. Ph√¥ tr∆∞∆°ng v·∫≠t ch·∫•t", "B. Gi·∫£n d·ªã, ti·∫øt ki·ªám, tr√¢n tr·ªçng t√†i s·∫£n", "C. Ch·ªâ quan t√¢m ƒë·∫øn b·∫£n th√¢n", "D. Ti√™u d√πng xa x·ªâ"], answer: "B" },
            { id: 9, text: "Nguy√™n t·∫Øc 6 chi·∫øc l·ªç trong chi ti√™u c√° nh√¢n gi√∫p gi·ªõi tr·∫ª:", options: ["A. Chi ti√™u theo c·∫£m x√∫c, kh√¥ng ki·ªÉm so√°t", "B. Bi·∫øt ph√¢n chia ti·ªÅn h·ª£p l√Ω, ∆∞u ti√™n nhu c·∫ßu, t√≠ch l≈©y cho t∆∞∆°ng lai v√† gi√∫p ng∆∞·ªùi kh√°c", "C. Mua s·∫Øm tr√†o l∆∞u m·∫°ng x√£ h·ªôi", "D. Ch·ªâ d√πng ti·ªÅn cho gi·∫£i tr√≠"], answer: "B" },
            { id: 10, text: "Qua c√°c c√¢u chuy·ªán v·ªÅ B√°c H·ªì, c√≥ th·ªÉ r√∫t ra b√†i h·ªçc n√†o cho gi·ªõi tr·∫ª hi·ªán nay?", options: ["A. Ti·∫øt ki·ªám ch·ªâ l√† ti·∫øt ki·ªám ti·ªÅn b·∫°c", "B. S·ªëng ti·∫øt ki·ªám l√† s·ªëng c√≥ tr√°ch nhi·ªám, bi·∫øt qu√Ω tr·ªçng t√†i nguy√™n v√† gi√∫p ƒë·ª° ng∆∞·ªùi kh√°c", "C. S·ªëng kham kh·ªï, thi·∫øu th·ªën", "D. Ch·ªâ quan t√¢m h∆∞·ªüng th·ª• c√° nh√¢n"], answer: "B" }
        ];

        const OBSTACLE_TYPES = ['ü™®', 'üöó', 'üöô', 'üì¶', 'üåµ'];
        const GROUND_DECOR = ['üå∑', 'üçÉ', '‚òòÔ∏è'];

        // --- COMPONENTS ---
        
        // Modal C√¢u H·ªèi v·ªõi hi·ªáu ·ª©ng Xanh/ƒê·ªè
        const QuestionModal = ({ question, onAnswer, playSound }) => {
            const [selected, setSelected] = useState(null);
            const [isConfirmed, setIsConfirmed] = useState(false);

            const handleSelect = (option) => {
                if (isConfirmed) return;
                const code = option.charAt(0);
                const isCorrect = code === question.answer;
                
                setSelected(code);
                setIsConfirmed(true);
                
                if (isCorrect) playSound('correct');
                else playSound('wrong');

                // Ch·ªù 1.5 gi√¢y ƒë·ªÉ xem k·∫øt qu·∫£ tr∆∞·ªõc khi nh·∫£y
                setTimeout(() => {
                    onAnswer(isCorrect);
                }, 1500);
            };

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-md p-4 overflow-y-auto">
                    <div className="bg-white rounded-[30px] md:rounded-[40px] w-full max-w-2xl overflow-hidden shadow-2xl border-4 border-white/50 my-auto">
                        <div className="bg-gradient-to-r from-blue-600 to-blue-500 p-6 md:p-10 text-white text-center">
                            <p className="text-xs uppercase font-black opacity-70 mb-2 tracking-widest">C√¢u {question.id}/10</p>
                            <h2 className="text-xl md:text-3xl font-bold leading-tight">{question.text}</h2>
                        </div>
                        <div className="p-6 md:p-10 space-y-3 bg-gray-50">
                            {question.options.map((opt, i) => {
                                const code = opt.charAt(0);
                                const isCorrectCode = code === question.answer;
                                const isSelectedCode = code === selected;

                                let btnStyle = "border-gray-200 bg-white text-gray-700 hover:bg-blue-50";
                                let icon = null;

                                if (isConfirmed) {
                                    if (isCorrectCode) {
                                        btnStyle = "bg-green-500 border-green-600 text-white shadow-[0_0_20px_rgba(34,197,94,0.5)]";
                                        icon = <span className="text-2xl animate-bounce">‚úîÔ∏è</span>;
                                    } else if (isSelectedCode) {
                                        btnStyle = "bg-red-500 border-red-600 text-white animate-shake shadow-[0_0_20px_rgba(239,68,68,0.5)]";
                                        icon = <span className="text-2xl">‚ùå</span>;
                                    } else {
                                        btnStyle = "border-gray-100 bg-gray-50 text-gray-400 opacity-50";
                                    }
                                }

                                return (
                                    <button 
                                        key={i} 
                                        disabled={isConfirmed}
                                        onClick={() => handleSelect(opt)}
                                        className={`w-full text-left p-4 md:p-6 rounded-2xl border-2 font-bold text-lg md:text-xl transition-all flex justify-between items-center ${btnStyle}`}
                                    >
                                        <span>{opt}</span>
                                        {icon}
                                    </button>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        };

        const StartScreen = ({ onStart }) => (
            <div className="w-full h-full flex flex-col items-center justify-center animate-gradient bg-gradient-to-br from-blue-400 via-purple-400 to-pink-400 p-4 text-center">
                <div className="flex flex-row flex-nowrap items-center justify-center gap-2 sm:gap-4 md:gap-6 mb-12 w-full max-w-full overflow-hidden px-2">
                    <span className="text-3xl sm:text-6xl md:text-8xl lg:text-9xl animate-bounce shrink-0">üèÅ</span>
                    <h1 className="text-[7vw] sm:text-4xl md:text-6xl lg:text-8xl font-black text-white drop-shadow-2xl font-bungee leading-none whitespace-nowrap px-1">
                        V∆Ø·ª¢T CH∆Ø·ªöNG NG·∫†I V·∫¨T
                    </h1>
                    <span className="text-3xl sm:text-6xl md:text-8xl lg:text-9xl animate-bounce shrink-0">üèÅ</span>
                </div>
                <button 
                    onClick={onStart} 
                    className="px-12 py-6 md:px-20 md:py-10 bg-white rounded-3xl shadow-2xl hover:scale-110 transition-all border-b-8 border-gray-200 active:translate-y-2 active:border-b-0"
                >
                    <span className="text-3xl md:text-5xl font-black text-blue-600 font-bungee uppercase">B·∫ÆT ƒê·∫¶U</span>
                </button>
            </div>
        );

        const GameView = ({ onGameOver, playSound }) => {
            const [distance, setDistance] = useState(0);
            const [isQuestionActive, setIsQuestionActive] = useState(false);
            const [currentIdx, setCurrentIdx] = useState(0);
            const [score, setScore] = useState(0);
            const [isJumping, setIsJumping] = useState(false);
            const [jumpY, setJumpY] = useState(0);
            const [jumpX, setJumpX] = useState(0);
            
            const isMobile = typeof window !== 'undefined' && window.innerWidth < 768;
            const ballXBase = isMobile ? 60 : 150; 

            const distanceRef = useRef(0);
            const obstacles = useRef([]);
            const groundDecor = useRef([]);
            const clouds = useRef([]);

            useEffect(() => {
                let lastPos = 1200;
                obstacles.current = Array.from({length: 10}, (_, i) => {
                    const gap = 1200 + Math.random() * 800;
                    lastPos += gap;
                    return { id: i, emoji: OBSTACLE_TYPES[Math.floor(Math.random()*OBSTACLE_TYPES.length)], pos: lastPos };
                });
                groundDecor.current = Array.from({length: 120}, (_, i) => ({
                    id: i, emoji: GROUND_DECOR[Math.floor(Math.random()*GROUND_DECOR.length)], x: i * 200 + Math.random()*100, y: Math.random()*30 + 5
                }));
                clouds.current = Array.from({length: 8}, (_, i) => ({
                    id: i, x: Math.random()*100, y: 5 + Math.random()*25, s: 0.05 + Math.random()*0.1, scale: 0.8 + Math.random()*1.8
                }));
            }, []);

            useEffect(() => {
                let frame;
                const loop = () => {
                    if (!isQuestionActive && !isJumping) {
                        distanceRef.current += 7;
                        setDistance(distanceRef.current);
                        const currentObstacle = obstacles.current[currentIdx];
                        if (currentObstacle && distanceRef.current + ballXBase + 180 >= currentObstacle.pos) {
                            setIsQuestionActive(true);
                        }
                    }
                    frame = requestAnimationFrame(loop);
                };
                frame = requestAnimationFrame(loop);
                return () => cancelAnimationFrame(frame);
            }, [isQuestionActive, isJumping, currentIdx, ballXBase]);

            const handleAnswer = (correct) => {
                if (correct) setScore(s => s + 1);
                
                setIsQuestionActive(false);
                setIsJumping(true);
                playSound('jump');

                let start = performance.now();
                const duration = 1200;
                const jumpLoop = (time) => {
                    let elapsed = time - start;
                    let p = elapsed / duration;
                    if (p > 1) p = 1;
                    const h = 350; 
                    setJumpY(-4 * h * Math.pow(p - 0.5, 2) + h);
                    setJumpX(p * 850); 
                    if (p < 1) requestAnimationFrame(jumpLoop);
                    else {
                        setIsJumping(false);
                        setJumpY(0); setJumpX(0);
                        distanceRef.current += 850;
                        if (currentIdx === 9) onGameOver(correct ? score + 1 : score);
                        else setCurrentIdx(i => i + 1);
                    }
                };
                requestAnimationFrame(jumpLoop);
            };

            return (
                <div className="w-full h-full bg-blue-400 relative overflow-hidden">
                    <div className="absolute inset-0 bg-gradient-to-b from-blue-500 to-blue-300" />
                    <div className="absolute top-6 right-6 text-[80px] md:text-[130px] opacity-40 animate-pulse">‚òÄÔ∏è</div>
                    
                    {clouds.current.map(c => (
                        <div key={c.id} className="absolute text-7xl md:text-9xl opacity-60" 
                             style={{ top: c.y+'%', left: (c.x + distance * 0.01 * c.s) % 130 - 15 + '%', transform: `scale(${c.scale})` }}>‚òÅÔ∏è</div>
                    ))}
                    
                    <div className="absolute bottom-0 w-full h-[20%] bg-green-600 border-t-8 border-green-700">
                        {groundDecor.current.map(d => (
                            <div key={d.id} className="absolute text-2xl md:text-3xl" style={{ bottom: d.y+'px', left: (d.x - distance) % 8000 + 'px' }}>{d.emoji}</div>
                        ))}
                    </div>

                    {obstacles.current.map(obs => {
                        const x = obs.pos - distance;
                        if (x < -600 || x > 2500) return null;
                        return (
                            <div key={obs.id} className="absolute bottom-[20%] text-[120px] md:text-[220px] transform drop-shadow-2xl z-10" 
                                 style={{ left: x + 'px', transform: `translateY(${obs.emoji === 'üì¶' ? '45%' : '25%'})` }}>{obs.emoji}</div>
                        );
                    })}

                    <div className="absolute bottom-[20%] z-20" 
                         style={{ left: (ballXBase + jumpX) + 'px', transform: `translate(-50%, ${-jumpY + 5}px) rotate(${distance*2.5}deg)` }}>
                        <div className="w-16 h-16 md:w-24 md:h-24 bg-red-600 rounded-full border-4 border-red-800 shadow-2xl ball-shadow relative overflow-hidden">
                            <div className="absolute top-2 left-4 md:left-5 w-6 h-3 md:w-8 md:h-4 bg-white/40 rounded-full" />
                        </div>
                    </div>

                    <div className="absolute top-20 left-4 md:top-24 md:left-6 px-6 py-2 md:px-10 md:py-4 bg-white/20 backdrop-blur-md rounded-full text-white font-black text-xl md:text-4xl border-2 border-white/40 shadow-lg z-30">
                        üèÜ ƒêI·ªÇM: {score}/10
                    </div>

                    {isQuestionActive && (
                        <QuestionModal 
                            question={QUESTIONS[currentIdx]} 
                            onAnswer={handleAnswer} 
                            playSound={playSound}
                        />
                    )}
                </div>
            );
        };

        const EndScreen = ({ score, onPlayAgain }) => (
            <div className="w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-green-400 via-blue-500 to-purple-600 text-white p-6 relative overflow-hidden text-center">
                <div className="z-10 w-full max-w-lg">
                    <h1 className="text-4xl md:text-7xl font-black font-bungee mb-6 drop-shadow-lg text-yellow-300">XU·∫§T S·∫ÆC!</h1>
                    <div className="bg-white/20 backdrop-blur-xl p-8 md:p-16 rounded-[40px] border-4 border-white/30 shadow-2xl mb-8">
                        <div className="text-8xl md:text-[150px] font-black font-bungee text-white drop-shadow-2xl">{score}/10</div>
                        <p className="text-xl font-black uppercase tracking-[0.2em] mt-4 opacity-90">C√¢u Tr·∫£ L·ªùi ƒê√∫ng</p>
                    </div>
                    <button onClick={onPlayAgain} className="px-12 py-6 bg-white text-blue-600 rounded-[30px] font-black text-2xl md:text-3xl font-bungee shadow-2xl hover:bg-yellow-400 hover:text-blue-900 active:scale-95 transition-all">
                        CH∆†I L·∫†I
                    </button>
                </div>
                {[...Array(30)].map((_, i) => (
                    <div key={i} className="absolute animate-ping rounded-full bg-yellow-300 opacity-50" 
                         style={{ width: Math.random()*20, height: Math.random()*20, top: Math.random()*100+'%', left: Math.random()*100+'%', animationDuration: (0.5+Math.random())+'s' }} />
                ))}
            </div>
        );

        const App = () => {
            const [state, setState] = useState('START');
            const [score, setScore] = useState(0);
            const [isMuted, setIsMuted] = useState(false);
            const audioCache = useRef({});
            const bgmRef = useRef(null);

            const unlockAudio = () => {
                if (isMuted) return;
                if (!bgmRef.current) {
                    const bgm = new Audio('bgm.mp3');
                    bgm.loop = true;
                    bgm.volume = 0.6;
                    bgmRef.current = bgm;
                }
                const sfxNames = ['click', 'correct', 'wrong', 'jump'];
                sfxNames.forEach(name => {
                    const a = new Audio(`${name}.mp3`);
                    a.volume = 0;
                    a.play().then(() => {
                        a.pause();
                        a.currentTime = 0;
                        a.volume = 0.5;
                        audioCache.current[name] = a;
                    }).catch(() => {});
                });
                if (bgmRef.current) bgmRef.current.play().catch(() => {});
            };

            const playSound = useCallback((type) => {
                if (isMuted) return;
                const audio = audioCache.current[type];
                if (audio) {
                    audio.currentTime = 0;
                    audio.play().catch(() => {});
                }
            }, [isMuted]);

            return (
                <div className="w-full h-screen relative bg-sky-950 overflow-hidden">
                    <button onClick={() => setIsMuted(!isMuted)} className="absolute top-4 right-4 z-[100] p-3 bg-white/20 backdrop-blur-lg border-2 border-white/30 rounded-2xl text-xl shadow-xl active:scale-90 transition-all">
                        {isMuted ? 'üîá' : 'üîä'}
                    </button>

                    {state === 'START' && <StartScreen onStart={() => { unlockAudio(); playSound('click'); setState('PLAY'); }} />}
                    {state === 'PLAY' && <GameView onGameOver={(s) => { setScore(s); setState('END'); }} playSound={playSound} />}
                    {state === 'END' && <EndScreen score={score} onPlayAgain={() => { playSound('click'); setState('START'); }} />}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>